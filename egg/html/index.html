<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="viewport" content="width=640,target-densitydpi=device-dpi,user-scalable=no" />
		<meta name="format-detection" content="telephone=no">
		<title>砸金蛋</title>
		<link rel="stylesheet" href="../css/style.css" />
		<!--<link rel="stylesheet" href="../css/animate.css" />-->
		<style>
			.loadingBox {
				position: absolute;
				width: 100%;
				height: 100%;
				/*background-color: #7aecc7;*/
				z-index: 10;
			}
			
			.loadingBox .loader {
				position: absolute;
				border-top: 0.4em solid rgba(255, 255, 255, 0.4);
				border-right: 0.4em solid rgba(255, 255, 255, 0.4);
				border-bottom: 0.4em solid rgba(255, 255, 255, 0.4);
				border-left: 0.4em solid #fff;
				-webkit-animation: loading 1.1s infinite linear;
				animation: loading 1.1s infinite linear;
			}
			
			.loadingBox .loader,
			.loadingBox .loader:after {
				position: absolute;
				border-radius: 50%;
				width: 50px;
				height: 50px;
				left: 50%;
				margin-left: -25px;
				top: 46%;
				margin-top: -25px;
			}
			
			.loader_txt {
				position: absolute;
				font-size: 28px;
				color: #fff;
				width: 640px;
				height: auto;
				text-align: center;
				top: 52%;
				font-weight: bold;
			}
			
			@-webkit-keyframes loading {
				0% {
					-webkit-transform: rotate(0deg);
					transform: rotate(0deg);
				}
				100% {
					-webkit-transform: rotate(360deg);
					transform: rotate(360deg);
				}
			}
			
			@keyframes loading {
				0% {
					-webkit-transform: rotate(0deg);
					transform: rotate(0deg);
				}
				100% {
					-webkit-transform: rotate(360deg);
					transform: rotate(360deg);
				}
			}
		</style>
	</head>

	<body class="bodySkin">
		<!--loading -->
		<div class="loadingBox">
			<div class="loader"></div>
			<div id="loader_txt" class="loader_txt">loading...0%</div>
		</div>

		<!--输入框-->
		<div id="inputBox" class="inputBox inputBoxHide">
			<div class="inputCon">
				<div class="name">
					<input id="name_input" class="input-name input-css" type="text" name="user" value="" placeholder="请输入姓名" maxlength="6" />
				</div>
				<div class="tel">
					<input id="tel_input" class="input-tel input-css" type="text" name="tel" value="" placeholder="请输入手机号码" maxlength="11" />
				</div>
				<div id="sureBtn" class="sureBtn btn">确定</div>
				<div id="cancelBtn" class="cancelBtn btn">取消</div>
			</div>
		</div>

		<!--领取成功 提示框-->
		<div id="hasExBox" class="hideMc hasExBox">
			<div class="hasExBg">
				<div id="title" class="title"></div>
				<div id="succeedFace" class="succeedFace"></div>
				<div id="hasExTxt" class="hasExTxt">领取成功!</div>
				<div id="hasExBtn" class="hasExBtn"></div>
			</div>
			<div class="closebtn" id="hasExBoxCloseBtn"></div>
		</div>

		<!--失败 提示框-->
		<div id="tipsBox" class="hideMc tipsBox">
			<div class="tipsBg">
				<div id="title" class="title"></div>
				<div id="failFace" class="failFace"></div>
				<div id="failTipsTxt" class="failTipsTxt">机会已抽完！</div>
				<div id="failBackBtn" class="failBackBtn"></div>
			</div>
			<div class="closebtn" id="tipsBoxCloseBtn"></div>
		</div>

		<!--再来一次提示框-->
		<div id="againGameBox" class="hideMc againGameBox">
			<div class="tipsBg">
				<div id="title" class="title"></div>
				<div id="face" class="face"></div>
				<div id="againTxt" class="againTxt">谢谢您的参与！</div>
				<div id="againGameBtn" class="againGameBtn"></div>
			</div>
			<div class="closebtn" id="againBoxCloseBtn"></div>
		</div>

		<!--绑定手机提示框-->
		<div id="erroBox" class="hideMc errorBox">
			<div class="tipsBg">
				<div id="title" class="title"></div>
				<div id="errorFace" class="errorFace"></div>
				<div id="errorTipsTxt" class="errorTipsTxt">请先登记电信手机<br>或电信宽带</div>
				<div id="errorBtn" class="errorBtn"></div>
			</div>
			<div class="closebtn" id="errorBoxCloseBtn"></div>
		</div>

		<!--中奖明细 0328修改 替换整个div内容-->
		<div id="page2" class="hideMc page2">
			<div class="scaleBox">
				<div class="bigPanel"></div>
				<div class="txt_detail"></div>
				<div class="closebtn" id="prizeBackBtn"></div>
				<div class="txtBox">
					<div class="txtBg"></div>

					<!--自己中奖榜单-->
					<div id="myPrizeList" class="myPrizeList">
						<img id="wechatImg" class="wechatImg" />
						<div id="wechatName" class="wechatName"></div>
						<div id="prizeWrapper" class="prizeWrapper">
							<div id="prizeScroller" class="aboutPrizeTxtBox">
								<ul id="aboutPrizetxtUl" class="txtUl">

								</ul>
							</div>
						</div>
						<div id="moreListBtn" class="moreListBtn"></div>
					</div>

					<!--更多中奖名单-->
					<div id="moreList " class="moreList hideList">
						<div id="prizeListWrapper" class="prizeListWrapper">
							<div id="listScroller" class="listScroller">
								<ul id="scroller-content" class="listConUl">

								</ul>
							</div>
							<!--<div id="scroller-pullUp" class= "slideTipsTxt">上拉加载更多</div>-->
							<!-- <div id = "scroller-pullUp">
                         <span id = "up-icon" class = "icon-double-angle-up pull-up-icon"></span>
                         <span id = "pullUp-msg" class = "pull-up-msg">上拉刷新</span>
                     </div>-->
						</div>
						<div class="slideTips slideTipsImg"></div>
						<div id="myListBtn" class="myListBtn"></div>
					</div>
				</div>
			</div>
		</div>

		<!--活动说明 0317修改 替换整个div内容-->
		<div id="page3" class="hideMc page3">
			<div class="scaleBox">
				<div class="bigPanel"></div>
				<div class="txt_rule"></div>
				<div class="closebtn" id="ruleBackBtn"></div>
				<div class="txtBox">
					<div class="txtBg"></div>
					<div id="ruleWrapper" class="ruleWrapper">
						<div id="ruleScroller" class="aboutRuleTxtBox">
							<ul id="aboutRuleTxtUl" class="txtUl">
							</ul>
						</div>
					</div>
				</div>
				<div class="icon"></div>
			</div>
		</div>

		<!--获奖页面-->
		<div id="page4" class="hideMc page4">
			<div class="scaleBox">
				<div class="bigPanel">
					<div class="txt_cong"></div>
					<div class="prize"></div>
					<div id="p4PrTxt" class="p4PrTxt"></div>
					<div class="name">
						<div id="name_txt" class="name_txt txt">请输入姓名</div>
					</div>
					<div class="tel">
						<div id="tel_txt" class="tel_txt txt">请输入手机号码</div>
					</div>
					<div id="subBtn" class="subBtn"></div>
				</div>

			</div>
		</div>

		<!--容器-->
		<div class="wrap">
			<!-- data-lock-next="true" data-lock-prev="true" -->
			<!--首页 0317修改 替换整个div内容-->
			<section class="screen screen1" data-lock-next="true" data-lock-prev="true">
				<div class="bgPic"></div>
				<div class="scaleBox page1">
					<div class="eggPanel">
						<div>
							<div class="eggShade1"></div>
							<div class="eggShade2"></div>
							<div class="eggShade3"></div>
						</div>
						<div class="eggGroup">
							<div class="egg egg1"></div>
							<div class="egg egg2"></div>
							<div class="egg egg3"></div>
						</div>
						<div class="crack"></div>
						<div class="dalog_q"></div>
						<!---->
						<div class="dalog_ok"></div>
						<div class="bigHammer"></div>
						<!---->
						<div class="chicken_l"></div>
						<div class="chicken_r"></div>
						<!---->
						<!--<div class="egg1_bigCracked"></div>
						<div class="egg2_bigCracked"></div>
						<div class="egg3_bigCracked"></div>
						<!---->
						<!--<div class="egg1_smCracked"></div>
						<div class="egg2_smCracked"></div>
						<div class="egg3_smCracked"></div>-->
						<!---->
						<!--<div class="firework"></div>-->
						<!--斜锤子-->
						<div class="hammer_s"></div>

					</div>

					<div id="aboutPrizeBtn" class="aboutPrizeBtn"></div>
					<div id="aboutRuleBtn" class="aboutRuleBtn"></div>

				</div>
				<div id="fireworkPanel">
					<div class="light_bg"></div>
					<div class="light_eggBg"></div>
				
					<div class="light_egg"></div>
					<div class="egg_bigCracked"></div>
						<div class="firework2"></div>
					<div class="firework1"></div>
				</div>
			</section>

			<!--恭喜你 中奖了-->
			<!--<section class="screen screen4" data-lock-next="true" data-lock-prev="true">
				<div class="scaleBox page4">
					<div class="lineBg"></div>
					<div class="txtBox">
						<div class="txtBg">
							<div class="box"></div>
							<div class="p4_t1"></div>
							<div class="prTipsBg">
								<div id="p4PrLvTxt" class="p4PrLvTxt"></div>
								<div id="p4PrTxt" class="p4PrTxt"></div>
							</div>
							<div class="tipsTxt">赶紧填写领奖资料抱回家吧~</div>-->

			<!--0325 修改以下div-->

			<!--<div class="name">
								<div id="name_txt" class="name_txt txt">请输入姓名</div>
							</div>
							<div class="tel">
								<div id="tel_txt" class="tel_txt txt">请输入手机号码</div>
							</div>
							<div id="code" class="code" style="display: none;">
								<div class="codeBtnTxt txt">获取验证码</div>
								<div id="code_txt" class="code_txt txt">验证码</div>
							</div>
							<div id="mask" class="mask hideMask"></div>
							<div class="telMask hideMask"></div>-->
			<!--<div id="bindTips" class="bindTips">本次参与活动的电信号码，以后可做深圳电信微信公众号</br>获得查询账单、流量通话等服务，请确保是本人操作。</div>-->
			<!--<div id="bindTips" class="bindTips"></div>
						</div>
					</div>

					<div id="subBtn" class="subBtn"></div>-->
			<!--</div>
			</section>-->
		</div>

		<div id="music" class="music">
			<audio id="bgMusic" class="audio" loop="" autoplay="autoplay" preload="" src="../mp3/bgSound.mp3"></audio>
			<div class="control">
				<div class="control-after"></div>
			</div>
		</div>

		<!--备注:项目发布上线之后以下JS请使用微信服务器的链接-->
		<script src="../js/wxmoment.min.js"></script>

		<script>
			//禁止屏幕的自动滑动
			document.addEventListener("touchmove", function(e) {
				e.preventDefault();
			}, false);

			//图片路径 修改
			var basePath = '../';

			////////  接口um
			var userData = {}; //用户信息。后台有交互请更新用户信息

			//记录用户剩余的抽奖机会次数   0=没有机会了   1=还有1次  2=还有2次  以此类推    0325新增的接口
			userData.getPrizeCount = 2;

			userData.userName = "111"; //用户中过奖,提交过的姓名  默认值为空""
			userData.userTel = "13800138000"; //用户中过奖,提交过的手机  默认值为空""   如果微信用户在电信公众号已经绑定了电信手机号(后台需要过滤联通,移动手机号),需要赋值绑定的手机号

			userData.notWrite = 0;


			//0317新增 接口    用户自定义banner图片名字
			userData.banPicUrl = basePath + "img/banner.jpg";

			//0328新增 接口  用户微信头像 相对路径  搜索basePath,可以修改绝对路径
			userData.wechatImgUrl = basePath + "wechatImg/test.jpg";

			//0328新增 接口  用户自己微信头
			userData.wechatName = "微信呢称";

			if (userData.userName == '') {
				userData.userName = userData.wechatName;
			}

			//客户自定义设置的 [游戏规则]    数组0代表第一条规则 , 数组1代表第二条规则   以此类推
			userData.initRule =
				"1.本活动全网用户皆可参与，每位参与活动的用户都可获得X次抽奖机会，同一用户（以手机识别）可X次兑换机会；<br>" +
				"2.所有中奖用户需按照指引填写正确的资料后才算成功提交领取申请，奖品审核后，在指定间内完成发放；<br>" +
				"3.此奖品兑换券不能兑换现金，逾期不补；<br>" +
				"4.本活动最终解释权归活动主办方所有，了解更多活动请关注公众号；<br>" +
				"d4safdsafdsafdsfdsafdsafdsafdsafdsfd\n" +
				"dfsafdsafdsafdsafdsafdsaf";

			//当前中奖信息
			userData.currentPrize = null;

			//"奖品明细" 用户已经中奖的奖品详情  默认等于空     0325新增的接口
			userData.selfPrize = [{
				date: "03/21",
				lvName: "一等奖",
				prizeName: "001奖品"
			}, {
				date: "03/22",
				lvName: "二等奖",
				prizeName: "002奖品"
			}, {
				date: "03/23",
				lvName: "三等奖",
				prizeName: "003奖品"
			}, {
				date: "03/24",
				lvName: "四等奖",
				prizeName: "004奖品"
			}, {
				date: "03/25",
				lvName: "五等奖",
				prizeName: "超长长长长长长长长长长长长长长长长长长长长长长长长长长长长的奖品"
			}, ];

			//"中奖名单"最多显示50个  默认等于空     0328新修改的接口
			userData.prizeList = [{
				tel: "138****8000",
				prizeName: "超长长长长长长长长长长长长长长长长长长长长长长长长长长长长的奖品"
			}, {
				tel: "138****8001",
				prizeName: "高清机顶盒"
			}, {
				tel: "138****8002",
				prizeName: "超长长长长长长长长长长长长长长长长长长长长长长长长长长长长的奖品"
			}, {
				tel: "138****8003",
				prizeName: "iphone 7"
			}, {
				tel: "138****8004",
				prizeName: "超长长长长长长长长长长长长长长长长长长长长长长长长长长长长的奖品"
			}, {
				tel: "138****8005",
				prizeName: "光纤一年"
			}];

			userData.prizeStyle = [{
				skin: "green",
				prizeState: 1
			}];

			//0405更改接口 初始化转盘奖项
			userData.initAllPrize = [1, 2, 6];

			//请求后台  进行抽奖   0328更改了函数
			function oneStart() {
				$.ajax({
					url: "../getPrize.json", //_path+"/lottery/random",
					type: 'get',
					async: false,
					data: {},
					dataType: 'json',
					success: function(datas) {
						if (datas.code == 1) {
							//							$u.prizeId = datas.prizeId;
							userData.currentPrize = datas;
							userData.selfPrize.push(datas);

							//获取中奖数据，开始转动转盘
							startGetPrizeCallBackFun(datas);
						} else { //请求中奖失败提示
							isBegin = false;
							//失败提示
							showFailTipsEvent(datas);
						};
					},
					error: function() {
						alert('服务器繁忙！');
						isBegin = false;
					}
				});
			}

			//  提交按钮  --- 提交资料   保存资料  手机号,姓名   0328更改了函数
			userData.isBusy = false; //确认按钮忙碌
			function saveDataFun() {
				userData.getPrizeCount--; //次数减一
				userData.currentPrize == null;
				getMoreListFun(true);
				//成功保存资料回调函数
				saveDataCallBackFun();
				return;
				//----------------测试代码 -----------------------
				//

				if (userData.isBusy) {
					return false;
				}
				userData.isBusy = true;
				$.ajax({
					url: "../saveData.json", //_path+"/lottery/saveUserInfo",
					type: 'get',
					async: false,
					data: {
					},
					dataType: 'json',
					success: function(datas) {
						if (datas.code == 1) {
							if (userData.notWrite == 0) {
								userData.userName = datas.name;
								userData.userTel = datas.tel;
							}
							userData.getPrizeCount--; //次数减一
							userData.currentPrize == null;

							getMoreListFun(true);

							//成功保存资料回调函数
							saveDataCallBackFun();
						} else {
							//失败提示
							showFailTipsEvent(datas);
							return false;
						}
						isSavingData = false;
						setTimeout(function() {
							userData.isBusy = false;
						}, 500);
					},
					error: function() {
						alert('服务器繁忙！');
						isSavingData = false;
						return false;
					}
				});
				console.info(userData);
			}

			// 获取更多中奖名单  返回20个? 50个?  后台自定义
			function getMoreListFun(isClear) {

				//请求更多中奖名单
				$.ajax({
					url: "../getList.json", //_path+"/detail/getWinningInfo",
					type: 'get',
					data: {
						//						'activityId': $u.aid,
						//						'p': $u.p
					},
					dataType: 'json',
					success: function(datas) {
						if (datas.code == 1) {
							//							$u.totalPage = datas.totalPage;
							getMoreListCallBackFun(datas, isClear);
						} else if (datas.code == 0) {
							//		            datas.error  后台返回的错误提示
							isLoadMoreBoo = false;
							app.$slideTips.removeClass("slideTipsTxt").addClass("slideTipsImg");
							app.$slideTips.text("");
							//失败提示
							showTipsEvent(datas);

							var liNum = app.$listConUl.find('li').length;
							if (liNum == 0) {
								app.$listConUl.text("暂无中奖记录");
							}
							return false;
						}
					},
					error: function() {
						alert('服务器繁忙！');
						isLoadMoreBoo = false;
						app.$slideTips.removeClass("slideTipsTxt").addClass("slideTipsImg");
						app.$slideTips.text("");
						return false;
					}
				});
			};
		</script>

		<script src="../js/lib.js"></script>
		<script src="../js/iscroll.js"></script>
	</body>

</html>